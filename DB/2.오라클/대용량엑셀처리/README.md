## 문제 상황
1. 개발, 운영에서는 문제없이 돌아가는 배치가 검증에서는 간헐적으로 에러가 발생
2. 에러가 발생하지 않을 때는 몇 초만에 배치가 해당 작업을 처리함
3. 에러는 다양하게 발생함. 엑셀 파일을 생성 실패, 엑셀은 생성이 되었으나 깨진 엑셀 파일, 조회 중 타임아웃 등
4. 종합적 원인은 쿼리가 30분 동안 돌면서 해당 쿼리를 kill하면서 로직이 의도치 않게 작동

## 문제 파악
1. 검증은 하나의 서버에서 여러 다른 처리를 동시에 처리함
2. 해당 배치는 주말에 한 번도 에러가 발생하지 않음
3. v$session_wait을 통해 해당 sid의 쿼리를 조회해보면, db file sequential read Event에서 wait하고 있음

### db file sequential read Event에서 wait 하고 있다는 것은?
-> db file sequential read 대기 이벤트에 빠진 상태에서 쿼리가 30분 넘게 실행되다가 타임아웃이 발생하는 상황은 성능 문제의 징후
-> 이런 경우 쿼리가 디스크 I/O 병목이나 잘못된 인덱스 사용, 혹은 데이터베이스의 설정 문제로 인해 성능 저하를 겪고 있을 가능성이 있음


## 문제 원인
1. 검증 테이블과 운영 테이블의 인덱싱이 다름
2. 검증 테이블은 통계 정보가 제대로 생성되어 있지 않음
3. 그로 인해 쿼리 실행 계획을 조회해본 결과, 일부 테이블이 FULL SCAN 되고 있었음 -> 약 몇 백만 row가 임시적으로 디스크에 저장 되어야 하는데 주말같이 넉넉할 때는 문제가 되지 않으나 리소스가 많이 필요한 시간에는 에러가 발생

## 문제 해결
1. 테이블 인덱싱 처리
2. FULL SCAN 일어나고 있는 테이블들의 인덱싱이 이미 되어 있다면 ANALYZE를 통해 통계 정보 생성 (ANALYZE TABLE 테이블명 COMPUTE STATISTICS)
